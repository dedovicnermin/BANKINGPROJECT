spring:
  kafka:
    bootstrap-servers: localhost:9092

  cloud:
    stream:
      function:
        definition: processInitialTransfer;singleBankProcessor;doubleBankProcessor;validationProcessor;validatedProcessor;transferErrorHandler;validationErrorHandler;failedTransferMetricHandler;processingTransferMetricHandler;persistedTransferMetricHandler;upsertMetric;balanceRequestProcessor


      bindings:
        failedTransferMetricHandler-in-0:
          destination: router.metrics.handler-failed
        failedTransferMetricHandler-out-0:
          destination: funds.transfer.status

        processingTransferMetricHandler-in-0:
          destination: router.metrics.handler-processing
        processingTransferMetricHandler-out-0:
          destination: funds.transfer.status

        persistedTransferMetricHandler-in-0:
          destination: router.metrics.handler-persist
        persistedTransferMetricHandler-out-0:
          destination: funds.transfer.status

        upsertMetric-in-0:
          destination: funds.transfer.status
        upsertMetric-out-0:
          destination: transfer.status


        processInitialTransfer-in-0:
          destination: funds.transfer.request
        processInitialTransfer-out-0:
          destination: router.trsf.error.handler
        processInitialTransfer-out-1:
          destination: router.trsf.singlebank.processor
        processInitialTransfer-out-2:
          destination: router.trsf.doublebank.processor

        transferErrorHandler-in-0:
          destination: router.trsf.error.handler
        transferErrorHandler-out-0:
          destination: funds.transfer.error

        singleBankProcessor-in-0:
          destination: router.trsf.singlebank.processor
        singleBankProcessor-out-0:
          destination: funds.transfer.111
        singleBankProcessor-out-1:
          destination: funds.transfer.222

        doubleBankProcessor-in-0:
          destination: router.trsf.doublebank.processor
        doubleBankProcessor-out-0:
          destination: router.validate.transfer

        validationProcessor-in-0:
          destination: router.validate.transfer
        validationProcessor-out-0:
          destination: router.validation.error.handler
        validationProcessor-out-1:
          destination: funds.validate.111
        validationProcessor-out-2:
          destination: funds.validate.222
        validationProcessor-out-3:
          destination: funds.validate.111
        validationProcessor-out-4:
          destination: funds.validate.222
        validationProcessor-out-5:
          destination: 

        validatedProcessor-in-0:
          destination: router.validated.fanout

        validationErrorHandler-in-0:
          destination: router.validation.error.handler
        validationErrorHandler-out-0:
          destination: funds.transfer.error













        balanceRequestProcessor-in-0:
          destination: balance.update.request
        balanceRequestProcessor-out-0:
          destination: balance.update.request.111
        balanceRequestProcessor-out-1:
          destination: balance.update.request.222
        balanceRequestProcessor-out-2:
          destination: balance.update.response


      kafka:
        streams:
          binder:
            configuration:
              default:
                key.serde: org.apache.kafka.common.serialization.Serdes$StringSerde
                value.serde: org.apache.kafka.common.serialization.Serdes$StringSerde
              commit.interval.ms: 1000
            min-partition-count: 1
            application-id: ROUTING-APP
            deserialization-exception-handler: logandcontinue





        bindings:
          upsertMetric-in-0:
            keySerde: org.apache.kafka.common.serialization.Serdes$StringSerde

          consumeInitialTransfer-in-0:
            enableDlq: true
            dlqName: funds.transfer.error





#balanceRequestConsumer
#consumeInitialTransfer
#validationConsumer


server:
  port: 7082


logging:
  level: debug

#        balanceRequestConsumer-in-0:
#          destination: balance.update.request


#     validationConsumer-in-0:
#          destination: router.validate.transfer
